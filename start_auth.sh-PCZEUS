#!/bin/bash

echo "======================================"
echo "ğŸ” Iniciando AUTH (Login) - PCZEUS"
echo "ğŸ“ Projeto: ~/DEV/Wiki-NHD/backend_auth"
echo "======================================"

# Garantia de caminho
cd /home/zeus/DEV/Wiki-NHD || {
  echo "âŒ Pasta Wiki-NHD nÃ£o encontrada"
  exit 1
}

# Validar venv
if [ ! -d "venv" ]; then
  echo "âŒ venv nÃ£o encontrado. Abortando."
  exit 1
fi

echo "ğŸ Ativando ambiente virtual..."
source venv/bin/activate

# ValidaÃ§Ã£o do venv
PY=$(which python3)
if [[ "$PY" != *"Wiki-NHD/venv"* ]]; then
  echo "âŒ Ambiente virtual incorreto"
  echo "Python atual: $PY"
  exit 1
fi

echo "âœ… venv correto ativo"

# Subir AUTH
echo "ğŸš€ Iniciando backend AUTH..."
cd backend_auth || exit 1

uvicorn app.main:app --host 0.0.0.0 --port 8501
