<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>NHD+ | N√∫cleo de Help Desk</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Fonte -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

    <!-- √çcone -->
    <link rel="icon" href="/static/images/wikiicone.png" type="image/png">

    <!-- CSS Global -->
    <link rel="stylesheet" href="/static/css/global.css">
    {% block extra_css %}{% endblock %}

    <style>
        :root {
            --primary: #0f2a44;
            --primary-light: #0b5ed7;
            --sidebar-bg: #0b1f33;
            --sidebar-hover: rgba(255,255,255,0.08);
            --text-light: #e5e7eb;
            --text-muted: #9ca3af;
        }

        body {
            margin: 0;
            font-family: 'Inter', sans-serif;
            background: #f4f6f9;
        }

        /* ================= SIDEBAR ================= */
        .sidebar {
            width: 240px;
            height: 100vh;
            background: linear-gradient(180deg, #0b1f33, #071726);
            position: fixed;
            left: 0;
            top: 0;
            display: flex;
            flex-direction: column;
            padding: 18px 14px;
            box-shadow: 4px 0 25px rgba(0,0,0,0.35);
            z-index: 1000;
        }

        .sidebar h2 {
            text-align: center;
            font-size: 20px;
            font-weight: 700;
            letter-spacing: 1px;
            margin-bottom: 30px;
            color: #ffffff;
        }

        .menu-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 16px;
            margin-bottom: 6px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 15px;
            color: var(--text-light);
            transition: all 0.25s ease;
        }

        .menu-item:hover {
            background: var(--sidebar-hover);
            transform: translateX(4px);
        }

        .zeus-botao {
            margin-top: auto;
            justify-content: center;
            background: linear-gradient(135deg, #2563eb, #38bdf8);
            font-weight: 600;
            box-shadow: 0 0 18px rgba(56,189,248,0.6);
        }

        /* ================= HEADER ENTERPRISE ================= */
.header {
    height: 72px;
    margin-left: 240px;
    padding: 0 32px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: linear-gradient(90deg, #0b1f33, #0b5ed7);
    color: white;
    box-shadow: 0 6px 20px rgba(0,0,0,0.35);
    position: sticky;
    top: 0;
    z-index: 900;
}

.header-left {
    display: flex;
    flex-direction: column;
}

.platform-name {
    font-size: 22px;
    font-weight: 800;
    letter-spacing: 1px;
}

.platform-subtitle {
    font-size: 13px;
    opacity: 0.85;
    margin-top: 2px;
}

.header-right {
    display: flex;
    align-items: center;
    gap: 16px;
}

.theme-toggle {
    background: rgba(255,255,255,0.15);
    border: none;
    color: white;
    font-size: 18px;
    padding: 6px 10px;
    border-radius: 8px;
    cursor: pointer;
    transition: all .2s ease;
}

.theme-toggle:hover {
    background: rgba(255,255,255,0.25);
}


        .header h1 {
            font-size: 22px;
            font-weight: 700;
            letter-spacing: .5px;
        }

        /* ================= CONTENT ================= */
        .content {
            margin-left: 240px;
            padding: 30px 40px;
            min-height: calc(100vh - 72px);
        }

        footer {
            margin-left: 240px;
            padding: 20px;
            text-align: center;
            background: #fff;
            border-top: 1px solid #e5e7eb;
            font-size: 14px;
        }

        /* ================= ZEUS BUTTON ================= */
        #zeusButton {
            position: fixed;
            bottom: 25px;
            right: 25px;
            width: 64px;
            height: 64px;
            background: linear-gradient(135deg, #2563eb, #38bdf8);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(0,0,0,0.35);
            animation: pulse 2s infinite;
            z-index: 2000;
        }

        #zeusButton img {
            width: 38px;
        }

        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 12px rgba(0,150,255,.4); }
            50% { transform: scale(1.08); box-shadow: 0 0 24px rgba(0,150,255,.9); }
            100% { transform: scale(1); box-shadow: 0 0 12px rgba(0,150,255,.4); }
        }

        /* ================= CHAT ZEUS ================= */
        .zeus-chat-box {
            position: fixed;
            bottom: 110px;
            right: 25px;
            width: 380px;
            height: 540px;
            display: none;
            flex-direction: column;
            background: rgba(255,255,255,.15);
            backdrop-filter: blur(18px);
            border-radius: 20px;
            border: 1px solid rgba(255,255,255,.25);
            box-shadow: 0 0 30px rgba(0,150,255,.4);
            overflow: hidden;
            z-index: 3000;
            animation: slideUp .35s ease;
        }

        @keyframes slideUp {
            from { transform: translateY(40px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .chat-header {
            background: linear-gradient(90deg, #2563eb, #38bdf8);
            padding: 14px;
            color: #fff;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-messages {
            flex: 1;
            padding: 14px;
            overflow-y: auto;
        }

        .msg {
            display: flex;
            gap: 10px;
            margin-bottom: 12px;
        }

        .msg img {
            width: 34px;
            height: 34px;
            border-radius: 50%;
        }

        .msg-text {
            background: #fff;
            padding: 10px 14px;
            border-radius: 10px;
            font-size: 14px;
            max-width: 80%;
            box-shadow: 0 2px 8px rgba(0,0,0,.1);
        }

        .msg-zeus .msg-text {
            background: linear-gradient(135deg, #e0ecff, #f5f9ff);
            border-left: 4px solid #2563eb;
        }

        .chat-input-area {
            display: flex;
            gap: 8px;
            padding: 12px;
            background: rgba(255,255,255,.9);
        }

        .chat-input-area input {
            flex: 1;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #d1d5db;
        }

        .chat-input-area button {
            padding: 10px 16px;
            border-radius: 8px;
            border: none;
            background: #2563eb;
            color: #fff;
            font-weight: 600;
            cursor: pointer;
        }
        /* ================= DARK MODE PROFISSIONAL ================= */
body.dark {
    background: #0f172a;
    color: #e5e7eb;
}

/* Header */
body.dark .header {
    background: linear-gradient(90deg, #020617, #0b3b8a);
}

/* Sidebar */
body.dark .sidebar {
    background: linear-gradient(180deg, #020617, #020617);
}

body.dark .menu-item {
    color: #e5e7eb;
}

body.dark .menu-item:hover {
    background: rgba(255,255,255,0.08);
}

/* Content */
body.dark .content {
    background: #020617;
}

/* Cards (portal, feed etc) */
body.dark .shortcut-card,
body.dark .incident-card {
    background: #020617;
    border: 1px solid rgba(255,255,255,0.08);
    box-shadow: 0 0 0 transparent;
}

/* Footer */
body.dark footer {
    background: #020617;
    color: #9ca3af;
    border-top: 1px solid rgba(255,255,255,0.08);
}

/* Chat Zeus */
body.dark .zeus-chat-box {
    background: rgba(2,6,23,0.95);
    border: 1px solid rgba(255,255,255,0.1);
}

body.dark .msg-text {
    background: #020617;
    color: #e5e7eb;
}

body.dark .msg-zeus .msg-text {
    background: linear-gradient(135deg, #1e3a8a, #1e40af);
    color: #fff;
}

    </style>
</head>

<body>

<!-- SIDEBAR -->
<div class="sidebar">
    <h2>NHD+</h2>

    <div class="menu-item" onclick="location.href='/portal'">üè† Portal</div>
    <div class="menu-item" onclick="location.href='/feed'">üì∞ Feed</div>
    <div class="menu-item" onclick="location.href='/incidentes'">üö® Incidentes</div>
    <div class="menu-item" onclick="location.href='/'">üìö Wiki</div>

    <div class="menu-item zeus-botao" onclick="abrirZeusChat()">ü§ñ Zeus IA</div>
</div>

<!-- HEADER -->
<div class="header">
    <div class="header-left">
        <div class="platform-subtitle">
            N√∫cleo de Help Desk ‚Ä¢ TJMA
        </div>
    </div>

    <div class="header-right">
        <button class="theme-toggle" onclick="toggleDark()">üåô</button>
    </div>
</div>



<!-- CONTENT -->
<div class="content">
    {% block content %}{% endblock %}
</div>

<!-- FOOTER -->
<footer>
    Wiki NHD ‚Ä¢ Desenvolvido por Maxwell Araujo
</footer>

<!-- BOT√ÉO ZEUS -->
<div id="zeusButton" onclick="abrirZeusChat()">
    <img src="/static/images/zeus.png">
</div>

<!-- CHAT ZEUS -->
<div id="zeusChat" class="zeus-chat-box">
    <div class="chat-header">
        ü§ñ Zeus ‚Äî Assistente
        <span style="cursor:pointer" onclick="fecharZeusChat()">‚úñ</span>
    </div>

    <div id="chatMessages" class="chat-messages"></div>

    <div class="chat-input-area">
        <input id="chatInput" placeholder="Digite sua pergunta..."
               onkeydown="if(event.key==='Enter') enviarZeus()">
        <button onclick="enviarZeus()">Enviar</button>
    </div>
</div>

<script>
function abrirZeusChat() {
    document.getElementById("zeusChat").style.display = "flex";
}

function fecharZeusChat() {
    document.getElementById("zeusChat").style.display = "none";
}

async function enviarZeus() {
    const input = document.getElementById("chatInput");
    const text = input.value.trim();
    if (!text) return;

    const box = document.getElementById("chatMessages");
    box.innerHTML += `
        <div class="msg msg-user">
            <img src="/static/images/user.png">
            <div class="msg-text">${text}</div>
        </div>`;
    input.value = "";

    const r = await fetch("http://localhost:8601/chat", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({ question: text })
    });

    const data = await r.json();

    box.innerHTML += `
        <div class="msg msg-zeus">
            <img src="/static/images/zeus.png">
            <div class="msg-text">${data.answer}</div>
        </div>`;

    box.scrollTop = box.scrollHeight;
}
</script>
<script>
function toggleDark() {
    document.body.classList.toggle("dark");

    localStorage.setItem(
        "nhd_theme",
        document.body.classList.contains("dark") ? "dark" : "light"
    );
}

// aplica automaticamente ao carregar qualquer p√°gina
window.addEventListener("DOMContentLoaded", () => {
    if (localStorage.getItem("nhd_theme") === "dark") {
        document.body.classList.add("dark");
    }
});
</script>

</body>
</html>
